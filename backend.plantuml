@startuml

!theme plain
top to bottom direction
skinparam linetype ortho

class AbstractAuditable {
   createdDate:  Date 
   lastModifiedDate:  Date 
}
class AbstractPersistable {
   id:  PK 
}
class AuditableEntity {
   createdAt:  Instant 
   updatedAt:  Instant 
}
class BloqueoAgenda {
   id:  UUID 
   fechaHoraFin:  Instant 
   fechaHoraInicio:  Instant 
   motivo:  String 
   veterinarioId:  UUID 
}
class Cita {
   id:  UUID 
   direccion:  String 
   estado:  EstadoCita 
   fechaHoraFin:  Instant 
   fechaHoraInicio:  Instant 
   metodoPagoSaldo:  MetodoPago 
   motivoConsulta:  String 
   origen:  OrigenCita 
   precioFinal:  int 
   staffFinalizadorId:  UUID 
   tipoAtencion:  TipoAtencion 
   tokenCompensacion:  String 
   tutorId:  UUID 
}
class DetalleCita {
   id:  UUID 
   precioUnitario:  int 
}
class FichaClinica {
   id:  UUID 
   alertaVeterinaria:  boolean 
   anamnesis:  String 
   autorId:  UUID 
   avaluoClinico:  String 
   citaId:  UUID 
   esVacuna:  boolean 
   fechaAtencion:  Instant 
   fechaDesparasitacion:  LocalDate 
   fechaProximaVacuna:  LocalDate 
   fechaProximoControl:  LocalDate 
   frecuenciaCardiaca:  Integer 
   frecuenciaRespiratoria:  Integer 
   hallazgosObjetivos:  String 
   motivoConsulta:  String 
   nombreVacuna:  String 
   observaciones:  String 
   pesoRegistrado:  Double 
   planTratamiento:  String 
   temperatura:  Double 
}
class Insumo {
   id:  UUID 
   nombre:  String 
   stockActual:  double 
   stockMinimo:  int 
   unidadMedida:  String 
   version:  Long 
}
class Mascota {
   id:  UUID 
   chipIdentificador:  String 
   especie:  Especie 
   esterilizado:  boolean 
   fechaNacimiento:  LocalDate 
   fechaUltimoTestRetroviral:  LocalDate 
   nombre:  String 
   observacionesClinicas:  String 
   pesoActual:  double 
   raza:  String 
   sexo:  Sexo 
   temperamento:  Temperamento 
   testRetroviralNegativo:  boolean 
}
class MascotaMedia {
   id:  UUID 
   fechaSubida:  Instant 
   tipo:  MediaType 
   titulo:  String 
   url:  String 
}
class PlanPreventivo {
   id:  UUID 
   fechaAplicacion:  Instant 
   fechaRefuerzo:  Instant 
   lote:  String 
   observaciones:  String 
   producto:  String 
   tipo:  TipoPreventivo 
}
class Promocion {
   id:  UUID 
   activa:  boolean 
   descripcion:  String 
   diasPermitidos:  String 
   fechaFin:  LocalDate 
   fechaInicio:  LocalDate 
   nombre:  String 
   serviciosTriggerIds:  Set<UUID> 
}
class PromocionBeneficio {
   servicioId:  UUID 
   tipo:  TipoDescuento 
   valor:  BigDecimal 
}
class ReglaPrecio {
   id:  UUID 
   pesoMax:  double 
   pesoMin:  double 
   precio:  int 
}
class ServicioInsumo {
   id:  UUID 
   cantidadRequerida:  double 
   critico:  boolean 
}
class ServicioMedico {
   id:  UUID 
   activo:  boolean 
   bloqueadoSiEsterilizado:  boolean 
   categoria:  CategoriaServicio 
   duracionMinutos:  int 
   especiesPermitidas:  Set<Especie> 
   nombre:  String 
   precioAbono:  Integer 
   precioBase:  int 
   requierePeso:  boolean 
   serviciosRequeridosIds:  Set<UUID> 
   stock:  Integer 
   version:  Long 
}
class SignosVitales {
   id:  UUID 
   fecha:  Instant 
   frecuenciaCardiaca:  String 
   peso:  double 
   temperatura:  double 
}
class User {
   id:  UUID 
   address:  String 
   authProvider:  AuthProvider 
   createdAt:  Instant 
   email:  String 
   fcmToken:  String 
   name:  String 
   passwordHash:  String 
   phone:  String 
   phoneVerified:  boolean 
   photoUrl:  String 
   role:  UserRole 
}

AbstractAuditable    -[#595959,plain]-^  AbstractPersistable 
BloqueoAgenda        -[#595959,plain]-^  AuditableEntity     
Cita                 -[#595959,plain]-^  AuditableEntity     
Cita                "1" <-[#595959,plain]-> "1..*" DetalleCita         
DetalleCita         "0..*" -[#595959,plain]-> "0..1" Mascota             
DetalleCita         "0..*" -[#595959,plain]-> "1" ServicioMedico      
FichaClinica         -[#595959,plain]-^  AuditableEntity     
FichaClinica        "0..*" -[#595959,plain]-> "1" Mascota             
Insumo               -[#595959,plain]-^  AuditableEntity     
Mascota              -[#595959,plain]-^  AuditableEntity     
Mascota             "1" <-[#595959,plain]-> "1..*" SignosVitales       
Mascota             "0..*" -[#595959,plain]-> "1" User                
MascotaMedia        "0..*" -[#595959,plain]-> "0..1" Mascota             
PlanPreventivo       -[#595959,plain]-^  AuditableEntity     
PlanPreventivo      "0..*" -[#595959,plain]-> "0..1" Mascota             
Promocion            -[#595959,plain]-^  AuditableEntity     
Promocion            *-[#595959,plain]-  PromocionBeneficio  
ReglaPrecio         "1..*" <-[#595959,plain]-> "1" ServicioMedico      
ServicioInsumo      "0..*" -[#595959,plain]-> "0..1" Insumo              
ServicioMedico       -[#595959,plain]-^  AuditableEntity     
ServicioMedico      "1" <-[#595959,plain]-> "1..*" ServicioInsumo      
SignosVitales        -[#595959,plain]-^  AuditableEntity     
@enduml
